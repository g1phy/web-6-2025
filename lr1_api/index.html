<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>api - web-2025</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "api";
        var mkdocs_page_input_path = "lr1_api.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> web-2025
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">–ì–ª–∞–≤–Ω–∞—è</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">lr1</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../lr1/">common</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">api</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#_2">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_3">üìã –ü—Ä–∏–º–µ—Ä –º–æ–¥–µ–ª–∏</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_4">üì§ –ü—Ä–∏–º–µ—Ä —Å—Ö–µ–º—ã –∑–∞–ø—Ä–æ—Å–∞</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_5">üì° –ü—Ä–∏–º–µ—Ä —Ä—É—á–∫–∏</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_6">üìç –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –±—é–¥–∂–µ—Ç–∞</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#curl-">üß™ –ü—Ä–∏–º–µ—Ä CURL-–∑–∞–ø—Ä–æ—Å–∞</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#testing-user-api-endpoints-with-curl">Testing User API Endpoints with curl</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#register-a-new-user">Register a new user</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#login-to-get-jwt-token">Login to get JWT token</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#get-current-user-info-replace-jwt_token-with-the-actual-token">Get current user info (replace JWT_TOKEN with the actual token)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#get-list-of-users-replace-jwt_token-with-the-actual-token">Get list of users (replace JWT_TOKEN with the actual token)</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#change-password-replace-jwt_token-with-the-actual-token">Change password (replace JWT_TOKEN with the actual token)</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#finance-endpoints">Finance Endpoints</a>
        <ul>
    <li class="toctree-l4"><a class="reference internal" href="#create-transaction">Create Transaction</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#create-account">Create Account</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#get-accounts">Get Accounts</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#create-category">Create category</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#create-budget">Create budget</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#get-categories">Get categories</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#expense-analysis">Expense Analysis</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#dashboard-summary">Dashboard Summary</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#spending-trends">Spending Trends</a>
    </li>
    <li class="toctree-l4"><a class="reference internal" href="#get-notifications">Get notifications</a>
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_7">üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_8">üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#_9">üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1">–ü—Ä–∞–∫—Ç–∏–∫–∞ 1 ‚Äî —Ç—ã–∫</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2">–ü—Ä–∞–∫—Ç–∏–∫–∞ 2 ‚Äî —Ç—ã–∫</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#3">–ü—Ä–∞–∫—Ç–∏–∫–∞ 3 ‚Äî —Ç—ã–∫</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">web-2025</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">lr1</li>
      <li class="breadcrumb-item active">api</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="_1">üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</h1>
<p>–í—Å–µ –∑–∞—â–∏—â—ë–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç—Ä–µ–±—É—é—Ç –ø–µ—Ä–µ–¥–∞—á–∏ JWT —Ç–æ–∫–µ–Ω–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ:</p>
<pre><code>Authorization: Bearer &lt;token&gt;
</code></pre>
<h2 id="_2">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö</h2>
<pre><code class="language-python">from sqlalchemy import create_engine
from sqlalchemy.orm import sessionmaker, declarative_base
from dotenv import load_dotenv
import os

load_dotenv()
DATABASE_URL = os.getenv(&quot;DATABASE_URL&quot;)

engine = create_engine(DATABASE_URL)
SessionLocal = sessionmaker(bind=engine)
Base = declarative_base()
</code></pre>
<h2 id="_3">üìã –ü—Ä–∏–º–µ—Ä –º–æ–¥–µ–ª–∏</h2>
<pre><code class="language-python">class Transaction(Base):
    __tablename__ = &quot;transactions&quot;
    id = Column(Integer, primary_key=True, index=True)
    user_id = Column(Integer, ForeignKey(&quot;users.id&quot;), nullable=False)
    account_id = Column(Integer, ForeignKey(&quot;accounts.id&quot;), nullable=False)
    amount = Column(Float, nullable=False)
    date = Column(Date, default=datetime.date.today)
    description = Column(String)
    type = Column(Enum(TransactionType), nullable=False)
</code></pre>
<h2 id="_4">üì§ –ü—Ä–∏–º–µ—Ä —Å—Ö–µ–º—ã –∑–∞–ø—Ä–æ—Å–∞</h2>
<pre><code class="language-python">class TransactionCreate(BaseModel):
    account_id: int
    amount: float
    date: Optional[date] = None
    description: Optional[str] = None
    type: Literal[&quot;income&quot;, &quot;expense&quot;]
    categories: List[TransactionCategoryCreate]
</code></pre>
<h2 id="_5">üì° –ü—Ä–∏–º–µ—Ä —Ä—É—á–∫–∏</h2>
<pre><code class="language-python">@router.post(&quot;/transactions&quot;, response_model=TransactionOut)
def create_transaction_endpoint(transaction: TransactionCreate, db: Session = Depends(get_db), current_user: User = Depends(get_current_user)):
    try:
        return create_transaction(db, transaction, current_user.id)
    except ValueError as e:
        raise HTTPException(status_code=400, detail=str(e))
</code></pre>
<h2 id="_6">üìç –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –±—é–¥–∂–µ—Ç–∞</h2>
<pre><code class="language-python">def check_budget_exceedance(db: Session, user_id: int, category_id: int):
    budgets = db.query(Budget).filter(Budget.user_id == user_id, Budget.category_id == category_id).all()
    for budget in budgets:
        if budget.start_date and budget.end_date:
            total_spent = ...
            if total_spent &gt; budget.limit_amount:
                create_notification(db, user_id, &quot;Budget Exceeded&quot;, f&quot;Spent: {total_spent}, Limit: {budget.limit_amount}&quot;)
</code></pre>
<h2 id="curl-">üß™ –ü—Ä–∏–º–µ—Ä CURL-–∑–∞–ø—Ä–æ—Å–∞</h2>
<h3 id="testing-user-api-endpoints-with-curl">Testing User API Endpoints with curl</h3>
<h4 id="register-a-new-user">Register a new user</h4>
<pre><code class="language-bash">curl -X POST &quot;http://127.0.0.1:8000/auth/register&quot; \
-H &quot;Content-Type: application/json&quot; \
-d '{&quot;username&quot;: &quot;testuser&quot;, &quot;email&quot;: &quot;test@example.com&quot;, &quot;password&quot;: &quot;secret&quot;}'
</code></pre>
<h4 id="login-to-get-jwt-token">Login to get JWT token</h4>
<pre><code class="language-bash">curl -X POST &quot;http://127.0.0.1:8000/auth/login&quot; \
-H &quot;Content-Type: application/x-www-form-urlencoded&quot; \
-d &quot;username=testuser&amp;password=secret&quot;
</code></pre>
<h4 id="get-current-user-info-replace-jwt_token-with-the-actual-token">Get current user info (replace JWT_TOKEN with the actual token)</h4>
<pre><code class="language-bash">curl -X GET &quot;http://127.0.0.1:8000/auth/users/me&quot; \
-H &quot;Authorization: Bearer $JWT_TOKEN&quot;
</code></pre>
<h4 id="get-list-of-users-replace-jwt_token-with-the-actual-token">Get list of users (replace JWT_TOKEN with the actual token)</h4>
<pre><code class="language-bash">curl -X GET &quot;http://127.0.0.1:8000/auth/users&quot; \
-H &quot;Authorization: Bearer $JWT_TOKEN&quot;
</code></pre>
<h4 id="change-password-replace-jwt_token-with-the-actual-token">Change password (replace JWT_TOKEN with the actual token)</h4>
<pre><code class="language-bash">curl -X POST &quot;http://127.0.0.1:8000/auth/change-password&quot; \
-H &quot;Content-Type: application/json&quot; \
-H &quot;Authorization: Bearer $JWT_TOKEN&quot; \
-d '{&quot;old_password&quot;: &quot;secret&quot;, &quot;new_password&quot;: &quot;newsecret&quot;}'
</code></pre>
<h3 id="finance-endpoints">Finance Endpoints</h3>
<h4 id="create-transaction">Create Transaction</h4>
<pre><code class="language-bash">curl -X POST &quot;http://127.0.0.1:8000/finance/transactions&quot; \
-H &quot;Content-Type: application/json&quot; \
-H &quot;Authorization: Bearer $JWT_TOKEN&quot; \
-d '{&quot;account_id&quot;: 1, &quot;amount&quot;: 50.0, &quot;description&quot;: &quot;Dinner&quot;, &quot;type&quot;: &quot;expense&quot;, &quot;categories&quot;: [{&quot;category_id&quot;: 2, &quot;allocated_amount&quot;: 50.0}]}'
</code></pre>
<h4 id="create-account">Create Account</h4>
<pre><code class="language-bash">curl -X POST &quot;http://127.0.0.1:8000/finance/accounts&quot; \
-H &quot;Content-Type: application/json&quot; \
-H &quot;Authorization: Bearer $JWT_TOKEN&quot; \
-d '{&quot;name&quot;: &quot;Checking&quot;, &quot;balance&quot;: 1000.0}'
</code></pre>
<h4 id="get-accounts">Get Accounts</h4>
<pre><code class="language-bash">curl -X GET &quot;http://127.0.0.1:8000/finance/accounts&quot; \
-H &quot;Authorization: Bearer $JWT_TOKEN&quot;
</code></pre>
<h4 id="create-category">Create category</h4>
<pre><code class="language-bash">curl -X POST &quot;http://127.0.0.1:8000/finance/categories&quot; \
-H &quot;Content-Type: application/json&quot; \
-H &quot;Authorization: Bearer $JWT_TOKEN&quot; \
-d '{&quot;name&quot;: &quot;Groceries&quot;, &quot;description&quot;: &quot;Food and supplies&quot;}'
</code></pre>
<h4 id="create-budget">Create budget</h4>
<pre><code class="language-bash">curl -X POST &quot;http://127.0.0.1:8000/finance/budgets&quot; \
-H &quot;Content-Type: application/json&quot; \
-H &quot;Authorization: Bearer $JWT_TOKEN&quot; \
-d '{&quot;category_id&quot;: 3, &quot;period&quot;: &quot;2025-05&quot;, &quot;limit_amount&quot;: 100.0, &quot;start_date&quot;: &quot;2025-04-01&quot;, &quot;end_date&quot;: &quot;2025-12-31&quot;}'
</code></pre>
<h4 id="get-categories">Get categories</h4>
<pre><code class="language-bash">curl -X GET &quot;http://127.0.0.1:8000/finance/categories&quot; \
-H &quot;Authorization: Bearer $JWT_TOKEN&quot;
</code></pre>
<h4 id="expense-analysis">Expense Analysis</h4>
<pre><code class="language-bash">curl -X GET &quot;http://127.0.0.1:8000/finance/analysis/expenses&quot; \
-H &quot;Authorization: Bearer $JWT_TOKEN&quot;
</code></pre>
<h4 id="dashboard-summary">Dashboard Summary</h4>
<pre><code class="language-bash">curl -X GET &quot;http://127.0.0.1:8000/finance/dashboard&quot; \
-H &quot;Authorization: Bearer $JWT_TOKEN&quot;
</code></pre>
<h4 id="spending-trends">Spending Trends</h4>
<pre><code class="language-bash">curl -X GET &quot;http://127.0.0.1:8000/finance/trends/spending&quot; \
-H &quot;Authorization: Bearer $JWT_TOKEN&quot;
</code></pre>
<h4 id="get-notifications">Get notifications</h4>
<pre><code class="language-bash">curl -X GET &quot;http://127.0.0.1:8000/finance/notifications&quot; \
-H &quot;Authorization: Bearer $JWT_TOKEN&quot;
</code></pre>
<h2 id="_7">üóÇ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞</h2>
<pre><code>lr1/
‚îú‚îÄ‚îÄ app/
‚îÇ   ‚îú‚îÄ‚îÄ models.py
‚îÇ   ‚îú‚îÄ‚îÄ schemas/
‚îÇ   ‚îú‚îÄ‚îÄ crud/
‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ database.py
‚îÇ   ‚îî‚îÄ‚îÄ main.py
‚îú‚îÄ‚îÄ alembic/
‚îú‚îÄ‚îÄ .env
‚îú‚îÄ‚îÄ requirements.txt
‚îî‚îÄ‚îÄ README.md
</code></pre>
<h2 id="_8">üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å</h2>
<ol>
<li>–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:</li>
</ol>
<pre><code>pip install -r requirements.txt
</code></pre>
<ol>
<li>–°–æ–∑–¥–∞—Ç—å –±–∞–∑—É PostgreSQL –∏ <code>.env</code>:</li>
</ol>
<pre><code>DATABASE_URL=postgresql://user:pass@localhost/dbname
</code></pre>
<ol>
<li>–ü—Ä–æ–≥–Ω–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏:</li>
</ol>
<pre><code>alembic upgrade head
</code></pre>
<ol>
<li>–ó–∞–ø—É—Å–∫:</li>
</ol>
<pre><code>uvicorn app.main:app --reload
</code></pre>
<h2 id="_9">üéØ –ü—Ä–∞–∫—Ç–∏–∫–∞</h2>
<h3 id="1">–ü—Ä–∞–∫—Ç–∏–∫–∞ 1 ‚Äî <a href="https://github.com/g1phy/web-6-2025/tree/laba_1/practics/PR1">—Ç—ã–∫</a></h3>
<h3 id="2">–ü—Ä–∞–∫—Ç–∏–∫–∞ 2 ‚Äî <a href="https://github.com/g1phy/web-6-2025/tree/laba_1/practics/PR2">—Ç—ã–∫</a></h3>
<h3 id="3">–ü—Ä–∞–∫—Ç–∏–∫–∞ 3 ‚Äî <a href="https://github.com/g1phy/web-6-2025/tree/laba_1/practics/PR3">—Ç—ã–∫</a></h3>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../lr1/" class="btn btn-neutral float-left" title="common"><span class="icon icon-circle-arrow-left"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../lr1/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
